<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Image Describe Chat</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
        button { padding: 10px 15px; margin-top: 10px; }
        img { max-width: 300px; margin-top: 10px; }
        .result { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>Image Describe Chat</h1>

    <form id="describeForm">
        <label for="prompt">Text Prompt (optional):</label>
        <textarea id="prompt" rows="3"></textarea>

        <label for="image">Upload Image (optional):</label>
        <input type="file" id="image" accept="image/*">

        <button type="submit">Send</button>
    </form>

    <div class="result" id="result"></div>

    <script>
        const form = document.getElementById("describeForm");
        const resultDiv = document.getElementById("result");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            resultDiv.innerHTML = "Processing...";

            const prompt = document.getElementById("prompt").value.trim();
            const imageFile = document.getElementById("image").files[0];

            const formData = new FormData();
            if (prompt) formData.append("prompt", prompt);
            if (imageFile) formData.append("image", imageFile);

            try {
                const response = await fetch("/api/describe", {
                    method: "POST",
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    let html = "";
                    if (data.image) {
                        html += `<img src="${data.image}" alt="Uploaded Image"><br>`;
                    }
                    if (data.blip_caption) {
                        html += `<strong>BLIP Caption:</strong> ${data.blip_caption}<br>`;
                    }
                    html += `<strong>RHINO Response:</strong> ${data.description}<br>`;
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = `<span style="color:red">Error: ${data.error}</span>`;
                }
            } catch (err) {
                resultDiv.innerHTML = `<span style="color:red">Error: ${err.message}</span>`;
            }
        });
    </script>
</body>
</html>
